# ü™ü Fun√ß√µes Window no SQL (Window Functions)

As **Window Functions** no SQL Server permitem realizar c√°lculos em um conjunto de linhas relacionado √† linha atual, sem a necessidade de agrupar os dados. Elas s√£o extremamente √∫tis para criar somat√≥rios, m√©dias, contagens acumuladas, classifica√ß√µes e muito mais.

---

## üìÜ **O que √© uma Window Function?**

Uma Window Function executa uma opera√ß√£o em um "conjunto de linhas" definido por uma **cl√°usula OVER()**, preservando as linhas individuais no resultado.

### üîπ Principais Caracter√≠sticas:
- Permite analisar dados relacionados √† linha atual.
- N√£o "agrupa" ou reduz o n√∫mero de linhas.
- Facilita opera√ß√µes como somas, m√©dias, classifica√ß√µes e totais cumulativos.

---

## üñäÔ∏è **Sintaxe B√°sica**

```sql
SELECT
    Coluna1,
    Coluna2,
    Fun√ß√£oWindow() OVER (PARTITION BY ColunaX ORDER BY ColunaY)
FROM Tabela;
```

- `PARTITION BY`: Define a divis√£o dos dados em "parti√ß√µes" (semelhante a um GROUP BY).
- `ORDER BY`: Define a ordem dentro da parti√ß√£o.


---

## üîπ **Exemplos de Window Functions Comuns**

### 1. **ROW_NUMBER()** - Numera√ß√£o das linhas

```sql
SELECT Nome, Salario,
    ROW_NUMBER() OVER (ORDER BY Salario DESC) AS RankingSalario
FROM Funcionarios;
```

### 2. **RANK()** e **DENSE_RANK()** - Ranqueamento

```sql
SELECT Nome, Salario,
    RANK() OVER (ORDER BY Salario DESC) AS Rank,
    DENSE_RANK() OVER (ORDER BY Salario DESC) AS DenseRank
FROM Funcionarios;
```

- `RANK()`: Pode pular n√∫meros (1, 2, 2, 4).
- `DENSE_RANK()`: N√£o pula (1, 2, 2, 3).

### 3. **SUM(), AVG(), COUNT()** com OVER()

```sql
SELECT Nome, Departamento, Salario,
    SUM(Salario) OVER (PARTITION BY Departamento) AS TotalSalarioDepartamento
FROM Funcionarios;
```

### 4. **LAG() e LEAD()** - Acessar linhas anteriores ou posteriores

```sql
SELECT Nome, Salario,
    LAG(Salario) OVER (ORDER BY Salario) AS SalarioAnterior,
    LEAD(Salario) OVER (ORDER BY Salario) AS SalarioProximo
FROM Funcionarios;
```


---

## üéâ **Quando usar Window Functions?**

- Precisa fazer opera√ß√µes "relativas" sem agrupar os dados.
- Deseja criar classifica√ß√µes ou calcular somat√≥rios acumulados.
- Quer acessar valores anteriores ou posteriores em rela√ß√£o √† linha atual.


---

## üåü **Resumo**

As **Window Functions** s√£o ferramentas poderosas que ajudam a construir consultas SQL mais eficientes e sofisticadas, especialmente para an√°lises e relat√≥rios.

No SQL Server, domin√°-las √© um grande diferencial! üöÄ

---

Quer que eu crie um segundo documento mostrando exemplos ainda mais avan√ßados? Tipo c√°lculo de m√©dia m√≥vel, totais acumulados ou porcentagens? üöÄ

